import{d as st,s as Y,t as Ot,v as $t,x as Lt,y as At,f as u,m as Ye,z as ge,g as Pt,q as O,r as f,o as y,c as D,a as o,w as r,e as a,j as p,F as et,A as tt,B as g,i as X,n as he,b as Mt,C as J,M as h,p as jt,k as Rt,E as Et,_ as Bt}from"./index-8f4b240e.js";import{u as Ht,H as Ft,O as Kt}from"./renewData-b5f738dc.js";function at(m,C){var k=Object.keys(m);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(m);C&&(w=w.filter(function($){return Object.getOwnPropertyDescriptor(m,$).enumerable})),k.push.apply(k,w)}return k}function lt(m){for(var C=1;C<arguments.length;C++){var k=arguments[C]!=null?arguments[C]:{};C%2?at(Object(k),!0).forEach(function(w){Lt(m,w,k[w])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(k)):at(Object(k)).forEach(function(w){Object.defineProperty(m,w,Object.getOwnPropertyDescriptor(k,w))})}return m}var Tt={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.74 6.68L7.5 2.9v8.59h1V2.91l3.76 3.77.71-.7-4.62-4.63a.5.5 0 00-.7 0L3.03 5.97l.7.7z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M2 11v2a1 1 0 001 1h10a1 1 0 001-1v-2h-1v2H3v-2H2z",fillOpacity:.9}}]},Jt=st({name:"UploadIcon",props:{size:{type:String},onClick:{type:Function}},setup(m,C){var{attrs:k}=C,w=Y(()=>m.size),{className:$,style:R}=Ot(w),P=Y(()=>["t-icon","t-icon-upload",$.value]),E=Y(()=>lt(lt({},R.value),k.style)),I=Y(()=>({class:P.value,style:E.value,onClick:q=>{var L;return(L=m.onClick)===null||L===void 0?void 0:L.call(m,{e:q})}}));return()=>$t(Tt,I.value)}});const _=m=>(jt("data-v-654d1ad9"),m=m(),Rt(),m),qt={style:{display:"flex","justify-content":"space-between","margin-bottom":"16px"}},Zt={style:{display:"flex","flex-wrap":"wrap",gap:"16px","margin-bottom":"16px"}},Qt={style:{display:"flex","align-items":"center"}},Gt=_(()=>a("div",{style:{"margin-right":"10px"}},"视频ID",-1)),Wt={style:{display:"flex","align-items":"center"}},Xt=_(()=>a("div",{style:{"margin-right":"10px"}},"Asset ID",-1)),Yt={style:{display:"flex","align-items":"center"}},ea=_(()=>a("div",{style:{"margin-right":"10px"}},"合集名称",-1)),ta={style:{display:"flex","align-items":"center"}},aa=_(()=>a("div",{style:{"margin-right":"10px"}},"合集Level",-1)),la={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},sa=_(()=>a("div",{style:{"margin-right":"10px"}},"合集Interest",-1)),oa={style:{display:"flex","flex-wrap":"wrap",gap:"8px","align-items":"center"}},ia={style:{display:"flex",gap:"8px","margin-left":"auto"}},na={style:{display:"flex","align-items":"center"}},ra={key:0,class:"video-detail"},da={class:"video-preview-section"},ua={class:"video-player-box"},ca={key:0,class:"video-container"},va=["src","poster"],_a={key:1,class:"video-cover"},pa=["src"],ma=_(()=>a("div",{class:"no-video-tip"},"暂无可播放视频",-1)),fa={key:2,class:"video-placeholder"},ga={class:"subtitle-section"},ha={class:"subtitle-buttons"},ya={key:0,class:"subtitle-editor"},ba={class:"subtitle-header"},Sa={class:"subtitle-actions"},ka={key:1,class:"subtitle-placeholder"},wa={class:"video-info-section"},xa={class:"info-group"},Ca={class:"detail-item"},Va=_(()=>a("span",{class:"label"},"Video ID:",-1)),Da={class:"value"},Ia={class:"detail-item"},Ua=_(()=>a("span",{class:"label"},"名称:",-1)),za={class:"value"},Na={class:"detail-item"},Oa=_(()=>a("span",{class:"label"},"定制化标签:",-1)),$a={class:"value"},La={class:"detail-item"},Aa=_(()=>a("span",{class:"label"},"Asset ID:",-1)),Pa={class:"value"},Ma={class:"detail-item"},ja=_(()=>a("span",{class:"label"},"视频时长:",-1)),Ra={class:"value"},Ea={class:"detail-item"},Ba=_(()=>a("span",{class:"label"},"上架状态:",-1)),Ha={class:"value"},Fa={class:"detail-item"},Ka=_(()=>a("span",{class:"label"},"视频备注:",-1)),Ta={class:"value"},Ja={class:"detail-item",style:{"justify-content":"flex-end"}},qa={class:"info-group"},Za={class:"detail-item"},Qa=_(()=>a("span",{class:"label"},"视频观看数:",-1)),Ga={class:"value"},Wa={class:"detail-item"},Xa=_(()=>a("span",{class:"label"},"视频完播数:",-1)),Ya={class:"value"},el={class:"detail-item"},tl=_(()=>a("span",{class:"label"},"视频点赞数:",-1)),al={class:"value"},ll={class:"detail-item"},sl=_(()=>a("span",{class:"label"},"视频收藏数:",-1)),ol={class:"value"},il={class:"info-group"},nl={class:"detail-item"},rl=_(()=>a("span",{class:"label"},"合集ID:",-1)),dl={class:"value"},ul={class:"detail-item"},cl=_(()=>a("span",{class:"label"},"合集名称:",-1)),vl={class:"value"},_l={class:"detail-item"},pl=_(()=>a("span",{class:"label"},"合集Level:",-1)),ml={class:"value"},fl={class:"detail-item"},gl=_(()=>a("span",{class:"label"},"合集Interest:",-1)),hl={class:"value"},yl={class:"detail-item",style:{"justify-content":"flex-end"}},bl={class:"info-group"},Sl={key:0},kl={class:"info-item"},wl=_(()=>a("span",{class:"info-label"},"修改人：",-1)),xl={class:"info-value"},Cl={class:"info-item"},Vl=_(()=>a("span",{class:"info-label"},"修改时间：",-1)),Dl={class:"info-value"},Il={class:"info-item"},Ul=_(()=>a("span",{class:"info-label"},"行数：",-1)),zl={class:"info-value"},Nl=_(()=>a("p",{class:"tip"},"支持视频格式：MP4、AVI等，单个文件不超过1GB",-1)),Ol={style:{"margin-top":"16px"}},$l=_(()=>a("div",{class:"section-title"},"已上传视频列表",-1)),Ll={key:1},Al={key:1};function Pl(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Et(m)}const Ml=st({__name:"index",setup(m){At();const C=u([]),k=u(!1),w=u(!1),$=u(""),R=u(""),P=u(""),E=u(""),I=u([]),q=u(""),L=u(!1),n=u(null),ve=u([]),ye=Y(()=>ve.value.map(t=>({label:t,value:t}))),z=Ye({current:1,pageSize:10,total:0,showJumper:!0,pageSizeOptions:[10,20,50]}),ot=[{colKey:"video_id",title:"视频ID",width:230,ellipsis:!0,cell:(t,{row:e})=>o(f("t-link"),{theme:"primary",hover:"underline",onClick:()=>gt(e)},{default:()=>[e.video_id]})},{colKey:"title",title:"视频名称",width:300,ellipsis:!0},{colKey:"asset_id",title:"AssetID",width:200,ellipsis:!0},{colKey:"series.name",title:"合集名称",width:200,ellipsis:!0},{colKey:"series_level",title:"合集Level",width:120,cell:({row:t})=>{var i;const e=(i=t==null?void 0:t.series)==null?void 0:i.level;if(!e||e==="<UNSET>")return o(f("t-tag"),{theme:"default"},{default:()=>[p("未设置")]});const l={easy:"success",medium:"warning",hard:"danger"};return o(f("t-tag"),{theme:l[e.toLowerCase()]||"default"},Pl(e)?e:{default:()=>[e]})}},{colKey:"series_interest",title:"合集Interest列表",width:200,cell:({row:t})=>{var l;const e=(l=t==null?void 0:t.series)==null?void 0:l.interest_list;return!e||!Array.isArray(e)||e.length===0?"-":e.join("; ")}},{colKey:"video_status",title:"上架状态",width:120}],it=[],nt=Y(()=>it.filter(t=>!I.value.includes(t)).map(t=>({label:t,value:t}))),rt=t=>{t&&!I.value.includes(t)&&(I.value.push(t),q.value="",te())},dt=t=>{I.value=I.value.filter(e=>e!==t),te()};function ut(t){const l=`search_video${t}lingotok`;return J.SHA256(l).toString()}function ct(t){const l=`get_video${t}lingotok`;return J.SHA256(l).toString()}function vt(t){const l=`update_video_info${t}lingotok`;return J.SHA256(l).toString()}function _t(t){const l=`upload_video_draft_subtitle${t}lingotok`;return J.SHA256(l).toString()}function pt(t){const l=`get_all_series_name${t}lingotok`;return J.SHA256(l).toString()}function ee(t="search_video"){const e=Date.now().toString();let l="";switch(t){case"get_video":l=ct(e);break;case"update_video_info":l=vt(e);break;case"upload_video_draft_subtitle":l=_t(e);break;case"upload_video":l=J.SHA256(`upload_video${e}lingotok`).toString();break;default:l=ut(e)}return{Timestamp:e,Signature:l}}async function B(){var t;k.value=!0;try{const e=ee(),i={offset:(z.current-1)*z.pageSize,limit:z.pageSize,...$.value&&{video_id:$.value},...R.value&&{asset_id:R.value},...P.value&&{series_name:P.value},...E.value&&{series_level:E.value},...I.value.length>0&&{series_interest_list:I.value}},d=await O.post("https://api.lingotok.ai/api/v1/video/search_video",i,{headers:e});if(((t=d.data)==null?void 0:t.code)===200&&Array.isArray(d.data.data.video_list)){const c=d.data.data.video_list.map(v=>({...v,_statusLoading:!1}));C.value=c,z.total=d.data.data.total||0}else C.value=[],z.total=0}catch(e){console.error("获取视频列表失败:",e),C.value=[],z.total=0}finally{k.value=!1}}const mt=async(t,e)=>{var l,i;if(!(e!=null&&e.video_id)){h.warning("视频ID不存在");return}try{e._statusLoading=!0;const d=e.video_id,c=localStorage.getItem("username")||"unknown",v={video_id:d,username:c,title:e.title,status:t?"online":"offline",customize:e.customize||""},U=ee("update_video_info"),x=await O.post("https://api.lingotok.ai/api/v1/video/update_video_info",v,{headers:U});if(((l=x.data)==null?void 0:l.code)===200)h.success("更新成功"),e.video_status=t?"online":"offline",B();else throw new Error(((i=x.data)==null?void 0:i.message)||"更新失败")}catch(d){console.error("更新视频信息失败:",d),h.error("更新失败："+(d instanceof Error?d.message:"未知错误")),await B()}finally{e._statusLoading=!1}},ft=t=>{z.current=t.current,z.pageSize=t.pageSize,B()},te=()=>{z.current=1,B()},gt=async t=>{var e;try{w.value=!0;const l=ee("get_video"),i=await O.post("https://api.lingotok.ai/api/v1/video/get_video",{video_id:t.video_id},{headers:l});((e=i.data)==null?void 0:e.code)===200?(n.value=i.data.data,L.value=!0,Z.value=t.video_status||"offline",G.value=t.comment||""):h.error("获取视频详情失败")}catch(l){console.error("获取视频详情失败:",l),h.error("获取视频详情失败")}finally{w.value=!1}},ht=t=>{if(!t)return"-";const e=Math.floor(t/1e3),l=Math.floor(e/60),i=Math.floor(l/60),d=l%60,c=e%60;return i>0?`${i}:${String(d).padStart(2,"0")}:${String(c).padStart(2,"0")}`:`${d}:${String(c).padStart(2,"0")}`},yt=t=>t?new Date(t*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",be=t=>({zh:"中文字幕",en:"英文字幕",ar:"阿拉伯语字幕",pinyin:"拼音字幕"})[t]||t,M=u(null),V=u(""),ae=u(!1),H=u(!1),N=u(!1),F=u(0),Se=t=>t?t.split(`
`).filter(e=>e.trim()).length:0,bt=async t=>{try{N.value=!1,M.value=t,ae.value=!0;const e=await O.get(t.subtitle_play_url);V.value=e.data,F.value=Se(e.data)}catch(e){console.error("获取字幕内容失败:",e),h.error("获取字幕内容失败"),V.value="",F.value=0}finally{ae.value=!1}},St=async()=>{var t,e,l,i,d;try{if(N.value=!0,M.value=null,ae.value=!0,(e=(t=n.value)==null?void 0:t.video)!=null&&e.draft_subtitle_url){const c=await O.get(n.value.video.draft_subtitle_url);V.value=c.data}else{const c=(d=(i=(l=n.value)==null?void 0:l.video)==null?void 0:i.subtitle_list)==null?void 0:d.find(v=>v.language==="zh");if(c){const v=await O.get(c.subtitle_play_url);V.value=v.data}else V.value=""}F.value=Se(V.value)}catch(c){console.error("获取草稿字幕内容失败:",c),h.error("获取草稿字幕内容失败"),V.value="",F.value=0}finally{ae.value=!1}},kt=async()=>{var t,e,l,i,d,c;if(!((e=(t=n.value)==null?void 0:t.video)!=null&&e.video_id)){h.warning("视频ID不存在");return}try{H.value=!0,console.log("开始保存字幕...");const v=new Blob([V.value],{type:"text/plain"}),U=Date.now(),x=localStorage.getItem("username")||"unknown",A=(i=(l=n.value)==null?void 0:l.video)==null?void 0:i.video_id,ne=`draft_subtitle_${A}_${x}_${U}.srt`,re=new File([v],ne,{type:"text/plain"});console.log("准备上传文件:",ne);const xe=new Kt({access_key_id:"UI29JOFHTKQRBVVQ06TT",secret_access_key:"vaMNt6dy5cJvXDlkzoWVNx3M8O0H5aIkneZSMZom",server:"https://obs.me-east-1.myhuaweicloud.com",timeout:60}),de=`draft_subtitle/${ne}`;console.log("开始上传到 OBS:",de);const ue=await xe.putObject({Bucket:"lingotok",Key:de,SourceFile:re});if(console.log("OBS 上传结果:",ue),ue.CommonMsg.Status===200){const K=`https://lingotok.obs.me-east-1.myhuaweicloud.com/${de}`;console.log("文件上传成功，URL:",K);const W=Se(V.value),me={video_id:A,username:x,draft_subtitle_url:K,draft_subtitle_rows:W};console.log("准备更新字幕信息:",me);const ce=ee("upload_video_draft_subtitle");console.log("请求头:",ce);const s=await O.post("https://api.lingotok.ai/api/v1/video/upload_video_draft_subtitle",me,{headers:ce});if(console.log("更新字幕信息响应:",s.data),((d=s.data)==null?void 0:d.code)===200)h.success("字幕保存成功"),n.value.video.draft_subtitle_url=K,n.value.video.draft_subtitle_rows=W,n.value.video.draft_subtitle_user=x,n.value.video.draft_subtitle_time=Math.floor(Date.now()/1e3),F.value=W;else throw new Error(((c=s.data)==null?void 0:c.message)||"更新失败")}else throw new Error("文件上传失败")}catch(v){console.error("保存字幕失败:",v),h.error("保存字幕失败："+(v instanceof Error?v.message:"未知错误"))}finally{H.value=!1}},le=u(null);ge(L,t=>{!t&&le.value&&le.value.pause()}),ge(L,t=>{t||(le.value&&le.value.pause(),M.value=null,V.value="",N.value=!1,F.value=0)}),Pt(()=>{var e;Ct();const t=Ht();(e=t.searchParams)!=null&&e.seriesName?(P.value=t.searchParams.seriesName,te(),t.setSearchParams({seriesName:""})):B()});const se=u(""),Z=u("offline"),_e=u(!1),oe=u(""),Q=u(""),G=u("");ge(()=>n.value,t=>{var e;t!=null&&t.video&&(se.value=t.video.title||"",Z.value=t.video.video_status||"offline",oe.value=t.video.customize||"",Q.value=((e=t.video.series)==null?void 0:e.name)||"",G.value=t.video.comment||"")},{immediate:!0});const Ce=async()=>{var t,e,l,i;if(!((e=(t=n.value)==null?void 0:t.video)!=null&&e.video_id)){h.warning("视频ID不存在");return}try{_e.value=!0;const d=n.value.video.video_id,c=localStorage.getItem("username")||"unknown",v={video_id:d,username:c,title:se.value,status:Z.value,customize:oe.value,series_name:Q.value,comment:G.value};console.log("准备更新视频信息:",v);const U=ee("update_video_info"),x=await O.post("https://api.lingotok.ai/api/v1/video/update_video_info",v,{headers:U});if(console.log("更新视频信息响应:",x.data),((l=x.data)==null?void 0:l.code)===200)h.success("更新成功"),n.value.video.title=se.value,n.value.video.video_status=Z.value,n.value.video.customize=oe.value,n.value.video.series?n.value.video.series.name=Q.value:n.value.video.series={name:Q.value},n.value.video.comment=G.value,B();else throw new Error(((i=x.data)==null?void 0:i.message)||"更新失败")}catch(d){console.error("更新视频信息失败:",d),h.error("更新失败："+(d instanceof Error?d.message:"未知错误"))}finally{_e.value=!1}},wt=()=>{te()},xt=()=>{$.value="",R.value="",P.value="",E.value="",I.value=[],q.value="",te()};async function Ct(){var t;try{const e=Date.now().toString(),l=pt(e),i={Timestamp:e,Signature:l},d=await O.post("https://api.lingotok.ai/api/v1/video/get_all_series_name",{},{headers:i});((t=d.data)==null?void 0:t.code)===200&&Array.isArray(d.data.data.series_name_list)?ve.value=d.data.data.series_name_list:ve.value=[]}catch(e){console.error("获取系列名称失败:",e),ve.value=[]}}const ke=u(!1);ge(()=>n.value,t=>{var e;if(t!=null&&t.video){const l=(e=t.video.subtitle_list)==null?void 0:e.some(i=>i.language==="zh");ke.value=l}else ke.value=!1},{immediate:!0});const pe=u(!1),j=Ye({series_name:""}),Ve=u(null),we=u(null),S=u([]),ie=u(!1),Vt={series_name:[{required:!0,message:"请输入系列名称",type:"error"}]},De=[{colKey:"name",title:"视频名称",width:250,ellipsis:!0},{colKey:"url",title:"视频地址",width:450,ellipsis:!0,cell:"url-cell"},{colKey:"uploadTime",title:"上传时间",width:180},{colKey:"operation",title:"操作",width:80,cell:"operation-cell"}],Dt=()=>{pe.value=!0,j.series_name="",S.value=[]},Ie=()=>{pe.value=!1,j.series_name="",S.value=[]},It=(t,e)=>{var d,c;console.log("上传成功回调:",t,e);let l="";if(Array.isArray(e)&&((d=e[0])!=null&&d.url)?l=e[0].url:Array.isArray(t.response)&&((c=t.response[0])!=null&&c.url)?l=t.response[0].url:typeof e=="string"&&(l=e),console.log("提取的视频URL:",l),!l){console.error("无法获取视频URL:",t,e),h.warning("无法获取视频URL，请检查上传是否成功");return}const i={name:t.name||"未命名",url:l,uploadTime:new Date().toLocaleString()};console.log("新视频对象:",i),S.value||(S.value=[]),S.value=[...S.value,i],console.log("更新后的上传列表:",S.value)},Ue=t=>{if(!t||!S.value)return;const e=S.value.findIndex(l=>l.name===t.name&&l.url===t.url);e>-1&&(S.value.splice(e,1),we.value&&we.value.removeFile(t.name))},Ut=t=>{var e;console.error("文件上传失败:",t),h.error(`文件上传失败：${((e=t.response)==null?void 0:e.error)||t.error||"未知错误"}`)},zt=async()=>{var e;if(await((e=Ve.value)==null?void 0:e.validate())){if(!S.value||S.value.length===0){h.warning("请先上传视频文件");return}ie.value=!0}},Nt=async()=>{var t,e;if(!j.series_name||S.value.length===0){h.warning("请选择合集并上传视频");return}try{H.value=!0;const l=localStorage.getItem("username")||"unknown",i=Date.now().toString(),d=J.SHA256(`upload_video${i}lingotok`).toString(),c={Timestamp:i,Signature:d},v={series_name:j.series_name,upload_video_map:S.value.reduce((x,A)=>(A&&A.url&&(x[A.name]=A.url),x),{})};console.log("提交的参数:",v),console.log("请求头:",c);const U=await O.post("https://api.lingotok.ai/api/v1/video/upload_video",v,{headers:c});if(((t=U.data)==null?void 0:t.code)===200)h.success("上传成功"),Ie(),ie.value=!1,B();else throw new Error(((e=U.data)==null?void 0:e.message)||"上传失败")}catch(l){console.error("上传失败:",l),h.error("上传失败："+(l.message||"未知错误"))}finally{H.value=!1}};return(t,e)=>{const l=f("t-loading"),i=f("t-button"),d=f("t-input"),c=f("t-select"),v=f("t-radio-button"),U=f("t-radio-group"),x=f("t-tag"),A=f("t-switch"),ne=f("t-popconfirm"),re=f("t-table"),xe=f("t-space"),de=f("t-card"),ue=f("t-textarea"),K=f("t-dialog"),W=f("t-form-item"),me=f("t-form"),ce=f("t-link");return y(),D("div",null,[o(l,{loading:w.value,fullscreen:"",overlay:""},null,8,["loading"]),o(de,{class:"row-container",bordered:!1},{default:r(()=>[o(xe,{direction:"vertical",style:{width:"100%"}},{default:r(()=>[a("div",qt,[o(i,{theme:"primary",onClick:Dt},{default:r(()=>[p("添加视频")]),_:1})]),a("div",Zt,[a("div",Qt,[Gt,o(d,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=s=>$.value=s),placeholder:"搜索视频ID（可选）",style:{width:"240px"},clearable:""},null,8,["modelValue"])]),a("div",Wt,[Xt,o(d,{modelValue:R.value,"onUpdate:modelValue":e[1]||(e[1]=s=>R.value=s),placeholder:"搜索Asset ID（可选）",style:{width:"240px"},clearable:""},null,8,["modelValue"])]),a("div",Yt,[ea,o(c,{modelValue:P.value,"onUpdate:modelValue":e[2]||(e[2]=s=>P.value=s),placeholder:"选择合集名称（可选）",style:{width:"240px"},options:ye.value,clearable:"",filterable:"","allow-input":""},null,8,["modelValue","options"])]),a("div",ta,[aa,o(U,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=s=>E.value=s),variant:"default-filled"},{default:r(()=>[o(v,{value:""},{default:r(()=>[p("全部")]),_:1}),o(v,{value:"easy"},{default:r(()=>[p("Easy")]),_:1}),o(v,{value:"medium"},{default:r(()=>[p("Medium")]),_:1}),o(v,{value:"hard"},{default:r(()=>[p("Hard")]),_:1})]),_:1},8,["modelValue"])]),a("div",la,[sa,a("div",oa,[(y(!0),D(et,null,tt(I.value,s=>(y(),X(x,{key:s,theme:"primary",closable:"",onClose:T=>dt(s)},{default:r(()=>[p(g(s),1)]),_:2},1032,["onClose"]))),128)),o(c,{modelValue:q.value,"onUpdate:modelValue":e[4]||(e[4]=s=>q.value=s),placeholder:"选择Interest（可选）",style:{width:"240px"},options:nt.value,onChange:rt},null,8,["modelValue","options"])])]),a("div",ia,[o(i,{theme:"default",onClick:xt},{default:r(()=>[p("重置")]),_:1}),o(i,{theme:"primary",onClick:wt},{default:r(()=>[p("搜索")]),_:1})])]),o(re,{"row-key":"video_id",data:C.value,columns:ot,bordered:!0,size:"small",loading:k.value,hover:!0,pagination:z,onPageChange:ft},{video_status:r(({row:s})=>[a("div",na,[o(ne,{content:`确认${s.video_status==="online"?"下架":"上架"}该视频吗？`,onConfirm:()=>mt(s.video_status!=="online",s)},{default:r(()=>[o(A,{loading:s._statusLoading,"model-value":s.video_status==="online",onChange:()=>{}},{label:r(({value:T})=>[p(g(T?"已上架":"已下架"),1)]),_:2},1032,["loading","model-value"])]),_:2},1032,["content","onConfirm"])])]),_:1},8,["data","loading","pagination"])]),_:1})]),_:1}),o(K,{visible:L.value,"onUpdate:visible":e[11]||(e[11]=s=>L.value=s),header:"视频详情",footer:!1,width:"1200px","close-on-overlay-click":!0},{default:r(()=>{var s,T,ze,Ne,Oe,$e,Le,Ae,Pe,Me,je,Re,Ee,Be,He,Fe,Ke,Te,Je,qe,Ze,Qe,Ge,We,Xe;return[n.value?(y(),D("div",ra,[a("div",da,[a("div",ua,[(s=n.value.video)!=null&&s.video_trans_code_play_url||(T=n.value.video)!=null&&T.video_play_url?(y(),D("div",ca,[a("video",{ref_key:"videoPlayer",ref:le,class:"video-player",src:((ze=n.value.video)==null?void 0:ze.video_trans_code_play_url)||((Ne=n.value.video)==null?void 0:Ne.video_play_url),poster:(Oe=n.value.video)==null?void 0:Oe.video_cover_url,controls:"",preload:"metadata"}," 您的浏览器不支持 HTML5 视频播放 ",8,va)])):($e=n.value.video)!=null&&$e.video_cover_url?(y(),D("div",_a,[a("img",{src:n.value.video.video_cover_url,alt:"视频封面"},null,8,pa),ma])):(y(),D("div",fa," 暂无封面和视频 "))]),a("div",ga,[a("div",ha,[(y(!0),D(et,null,tt((Le=n.value.video)==null?void 0:Le.subtitle_list,b=>{var fe;return y(),X(i,{key:b.language,variant:"outline",theme:((fe=M.value)==null?void 0:fe.language)===b.language?"primary":"default",onClick:jl=>bt(b)},{default:r(()=>[p(g(be(b.language)),1)]),_:2},1032,["theme","onClick"])}),128)),ke.value?(y(),X(i,{key:0,variant:"outline",theme:N.value?"primary":"default",onClick:St},{default:r(()=>[p(" 中文草稿字幕 ")]),_:1},8,["theme"])):he("",!0)]),M.value||N.value?(y(),D("div",ya,[a("div",ba,[a("span",null,g(N.value?"中文草稿字幕":be(M.value.language))+"内容",1),a("div",Sa,[N.value?(y(),X(i,{key:0,theme:"primary",size:"small",onClick:kt,loading:H.value},{default:r(()=>[p(" 保存 ")]),_:1},8,["loading"])):he("",!0)])]),o(l,{loading:ae.value},{default:r(()=>{var b;return[o(ue,{modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=fe=>V.value=fe),placeholder:`请输入${N.value?"中文草稿字幕":be(M.value.language)}内容`,autosize:{minRows:10,maxRows:20},readonly:((b=M.value)==null?void 0:b.language)!=="zh"&&!N.value},null,8,["modelValue","placeholder","readonly"])]}),_:1},8,["loading"])])):(y(),D("div",ka," 请选择要编辑的字幕 "))])]),a("div",wa,[a("div",xa,[a("div",Ca,[Va,a("span",Da,g(((Ae=n.value.video)==null?void 0:Ae.video_id)||"-"),1)]),a("div",Ia,[Ua,a("div",za,[o(d,{modelValue:se.value,"onUpdate:modelValue":e[6]||(e[6]=b=>se.value=b),placeholder:"请输入视频名称",style:{width:"300px"}},null,8,["modelValue"])])]),a("div",Na,[Oa,a("div",$a,[o(d,{modelValue:oe.value,"onUpdate:modelValue":e[7]||(e[7]=b=>oe.value=b),placeholder:"请输入定制化标签",style:{width:"300px"}},null,8,["modelValue"])])]),a("div",La,[Aa,a("span",Pa,g(((Pe=n.value.video)==null?void 0:Pe.asset_id)||"-"),1)]),a("div",Ma,[ja,a("span",Ra,g(ht((Me=n.value.video)==null?void 0:Me.duration)),1)]),a("div",Ea,[Ba,a("div",Ha,[o(U,{modelValue:Z.value,"onUpdate:modelValue":e[8]||(e[8]=b=>Z.value=b)},{default:r(()=>[o(v,{value:"online"},{default:r(()=>[p("上架")]),_:1}),o(v,{value:"offline"},{default:r(()=>[p("下架")]),_:1})]),_:1},8,["modelValue"])])]),a("div",Fa,[Ka,a("div",Ta,[o(ue,{modelValue:G.value,"onUpdate:modelValue":e[9]||(e[9]=b=>G.value=b),placeholder:"请输入视频备注",maxlength:500,autosize:{minRows:3,maxRows:5}},null,8,["modelValue"])])]),a("div",Ja,[o(i,{theme:"primary",size:"small",onClick:Ce,loading:_e.value},{default:r(()=>[p(" 保存修改 ")]),_:1},8,["loading"])])]),a("div",qa,[a("div",Za,[Qa,a("span",Ga,g(((je=n.value.video)==null?void 0:je.watch_cnt)||0),1)]),a("div",Wa,[Xa,a("span",Ya,g(((Re=n.value.video)==null?void 0:Re.watch_complete_cnt)||0),1)]),a("div",el,[tl,a("span",al,g(((Ee=n.value.video)==null?void 0:Ee.like_cnt)||0),1)]),a("div",ll,[sl,a("span",ol,g(((Be=n.value.video)==null?void 0:Be.favorite_cnt)||0),1)])]),a("div",il,[a("div",nl,[rl,a("span",dl,g(((Fe=(He=n.value.video)==null?void 0:He.series)==null?void 0:Fe.id)||"-"),1)]),a("div",ul,[cl,a("div",vl,[o(c,{modelValue:Q.value,"onUpdate:modelValue":e[10]||(e[10]=b=>Q.value=b),placeholder:"选择合集名称",style:{width:"300px"},options:ye.value,clearable:"",filterable:"","allow-input":""},null,8,["modelValue","options"])])]),a("div",_l,[pl,a("span",ml,g(((Te=(Ke=n.value.video)==null?void 0:Ke.series)==null?void 0:Te.level)==="<UNSET>"?"未配置":((qe=(Je=n.value.video)==null?void 0:Je.series)==null?void 0:qe.level)||"-"),1)]),a("div",fl,[gl,a("span",hl,g(((Ge=(Qe=(Ze=n.value.video)==null?void 0:Ze.series)==null?void 0:Qe.interest_list)==null?void 0:Ge.join(", "))||"-"),1)]),a("div",yl,[o(i,{theme:"primary",size:"small",onClick:Ce,loading:_e.value},{default:r(()=>[p(" 保存修改 ")]),_:1},8,["loading"])])]),a("div",bl,[N.value?(y(),D("div",Sl,[a("div",kl,[wl,a("span",xl,g(((We=n.value.video)==null?void 0:We.draft_subtitle_user)||"-"),1)]),a("div",Cl,[Vl,a("span",Dl,g(yt((Xe=n.value.video)==null?void 0:Xe.draft_subtitle_time)),1)]),a("div",Il,[Ul,a("span",zl,g(F.value),1)])])):he("",!0)])])])):he("",!0)]}),_:1},8,["visible"]),o(K,{visible:pe.value,"onUpdate:visible":e[13]||(e[13]=s=>pe.value=s),header:"上传视频","confirm-btn":{content:"确认上传",loading:H.value},"cancel-btn":{content:"取消"},onConfirm:zt,onClose:Ie,width:"1000px"},{default:r(()=>[o(me,{ref_key:"uploadFormRef",ref:Ve,data:j,rules:Vt},{default:r(()=>[o(W,{label:"选择合集",name:"series_name"},{default:r(()=>[o(c,{modelValue:j.series_name,"onUpdate:modelValue":e[12]||(e[12]=s=>j.series_name=s),placeholder:"请选择合集",options:ye.value,clearable:"",filterable:"","allow-input":""},null,8,["modelValue","options"])]),_:1}),o(W,{label:"上传视频"},{default:r(()=>[o(Ft,{ref_key:"obsUploadRef",ref:we,accept:"video/*","max-size":1024*1024*1024,multiple:!0,"max-files":10,folder:"videos",onSuccess:It,onError:Ut},{tip:r(()=>[Nl]),default:r(()=>[o(i,{theme:"primary"},{default:r(()=>[o(Mt(Jt)),p("选择视频 ")]),_:1})]),_:1},512)]),_:1})]),_:1},8,["data"]),a("div",Ol,[$l,o(re,{data:S.value,columns:De,bordered:!0,size:"small",style:{"margin-top":"8px"}},{"url-cell":r(({row:s})=>[s.url?(y(),X(ce,{key:0,href:s.url,target:"_blank",theme:"primary",hover:"underline"},{default:r(()=>[p(g(s.url),1)]),_:2},1032,["href"])):(y(),D("span",Ll,"-"))]),"operation-cell":r(({row:s})=>[o(i,{theme:"danger",variant:"text",onClick:T=>Ue(s)},{default:r(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1},8,["data"])])]),_:1},8,["visible","confirm-btn"]),o(K,{visible:ie.value,"onUpdate:visible":e[14]||(e[14]=s=>ie.value=s),header:"确认上传","confirm-btn":{content:"确认",loading:H.value},"cancel-btn":{content:"取消"},onConfirm:Nt,onClose:e[15]||(e[15]=s=>ie.value=!1)},{default:r(()=>[a("p",null,'确认将以下视频上传到合集"'+g(j.series_name)+'"？',1),o(re,{data:S.value,columns:De,size:"small",bordered:!0},{"url-cell":r(({row:s})=>[s.url?(y(),X(ce,{key:0,href:s.url,target:"_blank",theme:"primary",hover:"underline"},{default:r(()=>[p(g(s.url),1)]),_:2},1032,["href"])):(y(),D("span",Al,"-"))]),"operation-cell":r(({row:s})=>[o(i,{theme:"danger",variant:"text",onClick:T=>Ue(s)},{default:r(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1},8,["data"])]),_:1},8,["visible","confirm-btn"])])}}});const Bl=Bt(Ml,[["__scopeId","data-v-654d1ad9"]]);export{Bl as default};
