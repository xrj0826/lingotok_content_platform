import{d as $,f as _,m as j,g as q,r as v,o as u,c as p,a as l,w as i,e,j as x,B as c,F as O,A as G,n as Q,q as U,M as I,p as W,k as X,C as Y,_ as Z}from"./index-8f4b240e.js";const h=f=>(W("data-v-74e22ad6"),f=f(),X(),f),ee={style:{display:"flex","flex-wrap":"wrap",gap:"16px","margin-bottom":"16px"}},te={style:{display:"flex","align-items":"center"}},se=h(()=>e("div",{style:{"margin-right":"10px"}},"用户ID",-1)),ae={style:{display:"flex",gap:"8px","margin-left":"auto"}},oe={key:0},ie={key:1},le={key:0,class:"video-detail"},ne={class:"video-preview-section"},de={class:"video-player-box"},re={key:0,class:"video-container"},ce=["src"],_e={key:1,class:"video-placeholder"},ue={class:"video-info-section"},pe={class:"info-group"},ve={class:"detail-item"},he=h(()=>e("span",{class:"label"},"视频ID:",-1)),ge={class:"value"},me={class:"detail-item"},fe=h(()=>e("span",{class:"label"},"标题:",-1)),ye={class:"value"},we={class:"detail-item"},Se=h(()=>e("span",{class:"label"},"原视频链接:",-1)),xe={class:"value"},be={class:"detail-item"},ke=h(()=>e("span",{class:"label"},"上传时间:",-1)),De={class:"value"},Ie={class:"detail-item"},Ce=h(()=>e("span",{class:"label"},"状态:",-1)),Ve={class:"value"},Ke=h(()=>e("p",null,"确定要删除该视频吗？此操作不可恢复。",-1)),Me=$({__name:"index",setup(f){const b=_([]),k=_(!1),y=_(""),C=_(""),V=_(!1),D=_(!1),n=_(null),K=_(null),d=j({current:1,pageSize:10,total:0,showJumper:!0,pageSizeOptions:[10,20,50]}),A=[{colKey:"id",title:"视频ID",width:180,ellipsis:!0},{colKey:"user_id",title:"用户ID",width:180,ellipsis:!0},{colKey:"create_time",title:"创建时间",width:180,cell:(t,{row:s})=>T(s.create_time)},{colKey:"origin_url",title:"原视频链接",width:400,cell:"link",ellipsis:!0},{colKey:"status",title:"状态",width:120,cell:"status"},{colKey:"gen_word_result",title:"单词卡",width:200,cell:"wordResult"},{colKey:"gen_video_asset_id",title:"生成视频AssetID",width:200,ellipsis:!0},{colKey:"gen_video_play",title:"生成视频链接",width:400,cell:"link",ellipsis:!0}],M=t=>({gen_word_processing:"warning",gen_word_failed:"danger",gen_video_processing:"primary",gen_video_failed:"danger",finished:"success"})[t]||"default",z=t=>({gen_word_processing:"单词卡生成中",gen_word_failed:"单词卡生成失败",gen_video_processing:"视频生成中",gen_video_failed:"视频生成失败",finished:"已完成"})[t]||"未知状态";function T(t){return t?new Date(t*1e3).toLocaleString():"-"}function N(t){const a=`search_self_video${t}lingotok`;return Y.SHA256(a).toString()}async function w(){var t,s;try{k.value=!0;const a=Date.now().toString(),g={Timestamp:a,Signature:N(a)},m={user_id:y.value||void 0,email:C.value||void 0,offset:(d.current-1)*d.pageSize,limit:d.pageSize},r=await U.post("https://api.lingotok.ai/api/v1/self_video/search_self_video",m,{headers:g});if(((t=r.data)==null?void 0:t.code)===200)b.value=(r.data.data.self_video_list||[]).map(S=>({...S,create_time:S.create_time||null})),d.total=r.data.data.total||0;else throw new Error(((s=r.data)==null?void 0:s.message)||"获取视频列表失败")}catch(a){console.error("获取视频列表失败:",a),I.error("获取视频列表失败："+(a.message||"未知错误")),b.value=[],d.total=0}finally{k.value=!1}}const P=async()=>{var t,s;if(K.value)try{const a=localStorage.getItem("username")||"",g={Timestamp:Date.now().toString(),Signature:N(Date.now().toString())},m={user_id:a,video_id:K.value.video_id},r=await U.post("https://api.lingotok.ai/api/v1/self_video/delete_self_video",m,{headers:g});if(((t=r.data)==null?void 0:t.code)===200)I.success("删除成功"),D.value=!1,w();else throw new Error(((s=r.data)==null?void 0:s.message)||"删除失败")}catch(a){console.error("删除失败:",a),I.error("删除失败："+(a.message||"未知错误"))}},L=()=>{d.current=1,w()},R=()=>{y.value="",C.value="",L()},F=t=>{d.current=t.current,d.pageSize=t.pageSize,w()};return q(()=>{w()}),(t,s)=>{const a=v("t-input"),g=v("t-button"),m=v("t-tag"),r=v("t-table"),S=v("t-space"),H=v("t-card"),B=v("t-dialog");return u(),p("div",null,[l(H,{class:"row-container",bordered:!1},{default:i(()=>[l(S,{direction:"vertical",style:{width:"100%"}},{default:i(()=>[e("div",ee,[e("div",te,[se,l(a,{modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=o=>y.value=o),placeholder:"搜索用户ID",style:{width:"240px"},clearable:""},null,8,["modelValue"])]),e("div",ae,[l(g,{theme:"default",onClick:R},{default:i(()=>[x("重置")]),_:1}),l(g,{theme:"primary",onClick:L},{default:i(()=>[x("搜索")]),_:1})])]),l(r,{"row-key":"id",data:b.value,columns:A,bordered:!0,size:"small",loading:k.value,hover:!0,pagination:d,onPageChange:F},{status:i(({row:o})=>[l(m,{theme:M(o.status)},{default:i(()=>[x(c(z(o.status)),1)]),_:2},1032,["theme"])]),wordResult:i(({row:o})=>[o.gen_word_result?(u(),p("div",oe,[(u(!0),p(O,null,G(o.gen_word_result,(J,E)=>(u(),p("div",{key:E},c(E)+": "+c(J),1))),128))])):(u(),p("span",ie,"-"))]),link:i(({row:o})=>[e("span",null,c(o.gen_video_play||"-"),1)]),_:1},8,["data","loading","pagination"])]),_:1})]),_:1}),l(B,{visible:V.value,"onUpdate:visible":s[1]||(s[1]=o=>V.value=o),header:"视频详情",footer:!1,width:"1200px","close-on-overlay-click":!0},{default:i(()=>[n.value?(u(),p("div",le,[e("div",ne,[e("div",de,[n.value.video_url?(u(),p("div",re,[e("video",{ref:"videoPlayer",class:"video-player",src:n.value.video_url,controls:"",preload:"metadata"}," 您的浏览器不支持 HTML5 视频播放 ",8,ce)])):(u(),p("div",_e," 暂无视频 "))])]),e("div",ue,[e("div",pe,[e("div",ve,[he,e("span",ge,c(n.value.video_id||"-"),1)]),e("div",me,[fe,e("span",ye,c(n.value.title||"-"),1)]),e("div",we,[Se,e("span",xe,c(n.value.origin_url||"-"),1)]),e("div",be,[ke,e("span",De,c(T(n.value.upload_time)),1)]),e("div",Ie,[Ce,e("span",Ve,[l(m,{theme:M(n.value.status)},{default:i(()=>[x(c(z(n.value.status)),1)]),_:1},8,["theme"])])])])])])):Q("",!0)]),_:1},8,["visible"]),l(B,{visible:D.value,"onUpdate:visible":s[2]||(s[2]=o=>D.value=o),header:"删除确认",theme:"warning","confirm-btn":{content:"确认",theme:"danger"},"cancel-btn":{content:"取消"},onConfirm:P},{body:i(()=>[Ke]),_:1},8,["visible"])])}}});const Te=Z(Me,[["__scopeId","data-v-74e22ad6"]]);export{Te as default};
